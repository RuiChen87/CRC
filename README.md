### CRC原理
---

网上查了些资料，总感觉写的不够详尽，这里根据自己的理解进行了整理。

**CRC是干什么的**

CRC：**C**yclic **R**edundancy **C**heck，即循环冗余检测，是用来检测信息是否出现错误或被干扰；也有将CRC理解成**C**yclic **R**edundance **C**ode，即循环冗余码。<br>

我更倾向于理解成循环冗余检测，即检测是否有错误。<br>

**CRC检测原理**

网上有很多资料进行介绍，这里按我自己的理解来说，就是**判断数据的余数是否为0，为0则数据是正确的，否则为错误的**。既然是求余数，那么被除数(即数据)是怎么来的？除数是怎么来的？说清楚了这2个问题，也就明白了CRC的原理。<br>

这里以13/4为例，这里的被除数为13，除数为4，可以看到余数为1，不为0。很明显，(13-1)/4的余数才是0。<br>

上面的这个例子就体现了CRC的原理：被除数(实际数据+余数)/除数，如果为0，则数据正确，如果不为0，则数据错误。<br>

**被除数**：实际信息+余数；<br>

**除数**：公认标准，也可以自己选择，不过使用过程中统一就行；<br>

**余数**：被除数/除数；<br>

**CRC相关术语**

在实际的实现过程中，可能存在一些差异，因而也就造成了一些术语，这里进行了整理，如下表所示：


术语/参数 | 含义
---|---
校验和位宽W | 校验数据的位宽，即余数的位宽
生成多项式 | 用来生成余数，即除数
初始值 | 余数的初始值
Refin | 输入数据是否翻转
Refout | 输出数据(余数)是否翻转
Xorout | 异或值

> 输入数据翻转是对数据的每个字节，而不是所有数据：如`08 32 5D`，翻转后为`10 4C BA`
> 输出数据翻转是对输出数据(余数)整个翻转，如余数为16位`08 32`，翻转后为`4C 10`


**主要标准**

名称 | 多项式 | 初始值 | 输入翻转 | 输出翻转 | 异或值 | 引用标准/用途
---|---|---|---|---|---|---
CRC-1 | A | - | - | - | - | 硬件，也称奇偶校验位
CRC-5-CCITT | B | - | - | - | - | ITU G.704标准
CRC-5-USB | C | - | - | - | - | USB信令包
CRC-7 | D | - | - | - | - | 通讯系统
CRC-8-ATM | E | - | - | - | - | ATM HEC
CRC-8-CCITT | F | - | - | - | - | 1-wire总线
CRC-8-Dallas/Maxim | G | - | - | - | - | 1-wirebus
CRC-8 | H | - | - | - | - | - 
CRC-10 | I | - | - | - | - | - 
CRC-12 | J | - | - | - | - | -
CRC-16-CCITT | K | - | - | - | - | X25、V.41、Bluetooth、PPP、IrDA
CRC-16-IBM | L | - | - | - | - | Modbus
CRC-16-BBS | M | - | - | - | - | XMODEM协议
CRC-32-IEEE802.3 | N | - | - | - | - | -
CRC-32C(Castagnoli) | O | - | - | - | - | -
CRC-64-ISO | P | - | - | - | - | ISO 3309
CRC-64-ECMA-182 | Q | - | - | - | - | ECMA-182



**生成多项式**

生成多项式的选取应该满足如下条件：
- 生成多项式的最高位和最低位必须为1？？？
- 当被传送信息（CRC码）任何一位发生错误时，被生成多项式做模2除后，应该使余数不为0
- 不同位发生错误时，应该使余数不同
- 对余数继续做模2除，应使余数循环

生成多项式表示的是除数的二进制形式，对应幂次前面的系数为对应bit位，由于二进制最高位恒为1，因而简记时将其去除了。<br>
常见生成多项式有：

序号 | 生成多项式 | 位宽 | 简记
---|---|---|---
A | $x+1$ | 0 | 0x01
B | $x^5+x^3+x+1$ | 5 | 0x0B
C | $x^5+x^2+1$ | 5 | 0x05
D | $x^7+x^3+1$ | 5 | 0x09
E | $x^5+x^2+1$ | 8 | 0x07
F | $x^8+x^7+x^3+x^2+1$ | 8 | 0x8D
G | $x^8+x^5+x^4+1$ | 8 | 0x31
H | $x^8+x^7+x^6+x^4+x^2+1$ | 8 | 0xD5
I | $x^{10}+x^9+x^5+x^4+x+1$ | 10 | 0x233
J | $x^{12}+x^{11}+x^3+x^2+x+1$ | 12 | 0x80F
K | $x^{16}+x^{12}+x^5+1$ | 16 | 0x1021
L | $x^{16}+x^{15}+x^2+1$ | 16 | 0x8005
M | $x^{16}+x^{15}+x^{10}+x^3$ | 16 | 0x8408
N | $x^{32}+x^{26}+x^{23}+x^{22}$<br>$+x^{16}+x^{12}+x^{11}+x^{10}$<br>$+x^8+x^7+x^5+x^4+x^2+x+1$ | 32 | 0x04C11DB7
O | $x^{32}+x^{28}+x^{27}+x^{26}$<br>$+x^{25}+x^{23}+x^{22}+x^{20}$<br>$+x^{19}+x^{18}+x^{14}+x^{13}$<br>$+x^{11}+x^{10}+x^9+x^8+x^6+1$ | 32 | 0x1EDC6F41
P | $x^{64}+x^4+x^3+x+1$ | 64 | 000000000000001B
Q | $x^{64}+x^{62}+x^{57}+x^{55}$<br>$x^{54}+x^{53}+x^{52}+x^{47}$<br>$x^{46}+x^{45}+x^{40}+x^{39}$<br>$x^{38}+x^{37}+x^{35}+x^{33}$<br>$x^{32}+x^{31}+x^{29}+x^{27}$<br>$x^{24}+x^{23}+x^{22}+x^{21}$<br>$x^{19}+x^{17}+x^{13}+x^{12}$<br>$x^{10}+x^9+x^7+x^4+x+1$<br> | 64 | 0x42F0E1EBA9EA3693

